<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Day In Their Shoes - Presentation with Audio</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the play/pause button */
        .play-pause-button {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
        }
        .play-pause-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .play-pause-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
        }
        /* Style for error messages */
        .error-message {
            color: #dc2626; /* red-600 */
            font-weight: bold;
            padding: 8px;
            border-radius: 8px;
            background-color: #fee2e2; /* red-100 */
            border: 1px solid #ef4444; /* red-500 */
        }
        /* Ensure iframe takes up available space and scrolls if content overflows */
        .pdf-viewer {
            width: 100%;
            height: calc(100vh - 200px); /* Adjust height to leave space for controls */
            border: 1px solid #e2e8f0; /* gray-200 */
            border-radius: 0.75rem; /* rounded-xl */
        }
        @media (min-width: 768px) { /* Medium screens and up */
            .pdf-viewer {
                height: calc(100vh - 150px); /* More space on larger screens */
            }
        }
    </style>
</head>
<body class="font-inter bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-4xl flex flex-col items-center space-y-6">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-4">A Day In Their Shoes</h1>
        <p class="text-gray-600 text-center mb-6">View the presentation and play the accompanying audio.</p>

        <!-- PDF Viewer -->
        <div class="w-full flex-grow flex flex-col items-center">
            <h2 class="text-xl font-semibold text-gray-700 mb-3">Presentation</h2>
            <iframe id="pdfViewer" src="A Day In Their Shoes1.pdf" class="pdf-viewer" frameborder="0">
                This browser does not support PDFs. Please download the PDF to view it: <a href="A Day In Their Shoes1.pdf" class="text-blue-500 hover:underline">Download PDF</a>.
            </iframe>
        </div>

        <!-- Audio Player Controls -->
        <div class="w-full max-w-sm flex flex-col items-center space-y-4 pt-6">
            <h2 class="text-xl font-semibold text-gray-700">Audio Narration</h2>
            <!-- Audio element: Using your local audio file 'A Day In Their Shoes.mp3' -->
            <!-- IMPORTANT: Please ensure this file is named EXACTLY 'A Day In Their Shoes.mp3' (including spaces and capitalization) -->
            <!-- and is located in the SAME directory as this HTML file. -->
            <!-- If issues persist, consider converting the MP3 to ensure its format is valid. -->
            <audio id="myAudio" src="A Day In Their Shoes.mp3" preload="auto" class="w-full"></audio>

            <!-- Play/Pause Button -->
            <button id="playPauseButton" class="play-pause-button bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-lg">
                Play Audio
            </button>

            <!-- Display area for messages (e.g., error messages) -->
            <div id="messageBox" class="text-sm text-gray-700 mt-2 text-center w-full"></div>
        </div>
    </div>

    <script>
        // Get references to the audio element, button, and message box
        const myAudio = document.getElementById('myAudio');
        const playPauseButton = document.getElementById('playPauseButton');
        const messageBox = document.getElementById('messageBox');
        const pdfViewer = document.getElementById('pdfViewer'); // Reference to the iframe

        let isPlaying = false; // Track the current playback state

        // Function to show a message in the message box
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.classList.remove('error-message'); // Clear previous error styling

            if (type === 'error') {
                messageBox.classList.add('error-message');
            } else {
                messageBox.classList.remove('text-red-600');
                messageBox.classList.add('text-blue-600'); // Default info color
            }
        }

        // Event listener for the play/pause button
        playPauseButton.addEventListener('click', async () => {
            if (playPauseButton.disabled) {
                showMessage("Cannot play: Audio file not found or accessible. Please check the file path.", 'error');
                return;
            }

            try {
                if (isPlaying) {
                    // If currently playing, pause the audio
                    myAudio.pause();
                    playPauseButton.textContent = 'Play Audio';
                    isPlaying = false;
                    showMessage('Audio paused.');
                } else {
                    // Attempt to play the audio
                    await myAudio.play();
                    playPauseButton.textContent = 'Pause Audio';
                    isPlaying = true;
                    showMessage('Audio playing...');
                }
            } catch (error) {
                // Catch any errors during playback (e.g., user gesture requirement, file not found)
                let specificMessage = `Error: ${error.message}.`;
                if (error.name === "NotAllowedError") {
                    specificMessage = "Autoplay prevented. Please click 'Play Audio' to start.";
                } else if (error.name === "AbortError") {
                    specificMessage = "Playback aborted (e.g., by another play request).";
                } else if (error.name === "NotFoundError") {
                    specificMessage = `Audio file not found: ${myAudio.src}. Please check the path and file name.`;
                }
                showMessage(`Playback failed: ${specificMessage}`, 'error');
                console.error("Audio playback error:", error);
                console.error("Full error object on playback failure:", error); // Added for more detailed logging
                isPlaying = false; // Ensure state is reset
                playPauseButton.textContent = 'Play Audio'; // Reset button text
            }
        });

        // Event listener for when the audio starts playing
        myAudio.addEventListener('play', () => {
            isPlaying = true;
            playPauseButton.textContent = 'Pause Audio';
            showMessage('Audio playing...');
            playPauseButton.disabled = false; // Ensure button is enabled
        });

        // Event listener for when the audio is paused
        myAudio.addEventListener('pause', () => {
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
            showMessage('Audio paused.');
        });

        // Event listener for when the audio ends
        myAudio.addEventListener('ended', () => {
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
            showMessage('Audio finished.');
        });

        // Event listener for when the audio fails to load or play
        myAudio.addEventListener('error', (e) => {
            let errorMessage = 'An unknown audio error occurred.';
            const error = e.target.error; // Get the MediaError object

            console.error("Audio element error event triggered:", e); // Log the event object
            console.error("MediaError object:", error); // Log the MediaError object

            if (error) {
                switch (error.code) {
                    case error.MEDIA_ERR_ABORTED:
                        errorMessage = 'Audio playback aborted.';
                        break;
                    case error.MEDIA_ERR_NETWORK:
                        errorMessage = 'A network error caused the audio download to fail. Check your internet connection or file path.';
                        break;
                    case error.MEDIA_ERR_DECODE:
                        errorMessage = 'The audio could not be decoded. Ensure it\'s a valid MP3 file.';
                        break;
                    case error.MEDIA_ERR_SRC_NOT_SUPPORTED:
                        errorMessage = `The audio format is not supported or the source "${myAudio.src}" was not found. ` +
                                       `Please **double-check the file name (including capitalization and spaces)** and ensure it is in the **same directory** as this HTML file. ` +
                                       `Also, ensure the MP3 file itself is not corrupted. If these checks are correct, consider converting your MP3 file to a new one using an online converter.`;
                        break;
                    default:
                        errorMessage = `An unspecified audio error occurred (Code: ${error.code}).`;
                        if (error.message) {
                            errorMessage += ` Message: ${error.message}`;
                        }
                }
            } else {
                errorMessage = 'An unknown audio error occurred with no specific error object. This often indicates the audio file was not found or accessible.';
            }

            showMessage(`Audio Error: ${errorMessage}`, 'error');
            console.error("Audio element error details:", errorMessage); // Log the constructed message
            console.log("Audio source currently set to:", myAudio.src); // Log the source for debugging
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
            playPauseButton.disabled = true; // Disable button if source is bad
        });

        // Event listener for when metadata is loaded (e.g., duration, dimensions)
        myAudio.addEventListener('loadedmetadata', () => {
            console.log("Metadata loaded. Audio duration:", myAudio.duration);
            showMessage('Audio metadata loaded. Click "Play Audio" to start.');
            playPauseButton.disabled = false; // Enable button if metadata loads
        });

        // Event listener for when enough data is loaded to play
        myAudio.addEventListener('canplay', () => {
            console.log("Audio is ready to play.");
            showMessage('Audio ready. Click "Play Audio" to start.');
            playPauseButton.disabled = false; // Enable button if can play
        });

        // Handle cases where the audio element might not have loaded metadata yet
        // This is important for browsers that require a user gesture to play media
        window.addEventListener('load', () => {
            console.log("Window loaded. Checking audio state.");
            console.log("myAudio.src:", myAudio.src);
            console.log("myAudio.readyState:", myAudio.readyState);
            console.log("myAudio.networkState:", myAudio.networkState);

            if (myAudio.networkState === HTMLMediaElement.NETWORK_NO_SOURCE) {
                showMessage(`Error: Audio source "${myAudio.src}" could not be found. Please ensure the MP3 file is in the correct location and named correctly.`, 'error');
                playPauseButton.disabled = true; // Disable button if source is bad
            } else if (myAudio.networkState === HTMLMediaElement.NETWORK_EMPTY) {
                showMessage('Audio element is empty. Source might be invalid or not yet set.', 'error');
                playPauseButton.disabled = true;
            } else if (myAudio.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
                showMessage('Audio ready. Click "Play Audio" to start.');
                playPauseButton.disabled = false;
            } else {
                showMessage('Loading audio...');
                playPauseButton.disabled = true;
            }

            // Check if PDF can be loaded (note: direct content access is often blocked by CORS)
            if (!pdfViewer.src) {
                showMessage('PDF source is not set. Please check the "src" attribute of the iframe.', 'error');
            }
        });

    </script>
</body>
</html>
