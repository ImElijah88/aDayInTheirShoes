<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Day In Their Shoes - Presentation with Audio</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for buttons */
        .interactive-button {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1); /* Stronger shadow */
            background: linear-gradient(145deg, #60a5fa, #3b82f6); /* Gradient blue */
            border: none;
            color: white;
        }
        .interactive-button:hover {
            transform: translateY(-3px); /* More pronounced lift */
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2), 0 4px 6px rgba(0, 0, 0, 0.15);
            background: linear-gradient(145deg, #3b82f6, #2563eb); /* Darker gradient on hover */
        }
        .interactive-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
            background: linear-gradient(145deg, #2563eb, #3b82f6); /* Reverse gradient on active */
        }
        .interactive-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            background: #9ca3af; /* gray-400 */
        }

        /* Style for error messages */
        .error-message {
            color: #dc2626; /* red-600 */
            font-weight: bold;
            padding: 8px;
            border-radius: 0.5rem; /* rounded-lg */
            background-color: #fee2e2; /* red-100 */
            border: 1px solid #ef4444; /* red-500 */
            margin-top: 1rem;
        }

        /* Ensure iframe takes up available space and scrolls if content overflows */
        .pdf-viewer {
            width: 100%;
            height: 400px; /* Default height */
            border: 1px solid #e2e8f0; /* gray-200 */
            border-radius: 0.75rem; /* rounded-xl */
            background-color: #ffffff; /* Ensure white background for viewer */
        }
        /* Media queries for responsive height of PDF viewer */
        @media (min-width: 768px) {
            .pdf-viewer {
                height: 500px; /* Larger height on medium screens */
            }
        }
        @media (min-width: 1024px) {
            .pdf-viewer {
                height: 600px; /* Even larger on large screens */
            }
        }

        .pdf-controls {
            @apply flex justify-end w-full mb-3; /* Align full-screen button to the right */
        }
    </style>
</head>
<body class="font-inter bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col items-center justify-center min-h-screen p-6">

    <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-5xl flex flex-col items-center space-y-8 transform transition-transform duration-300 hover:scale-[1.01]">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-4 text-center">A Day In Their Shoes</h1>
        <p class="text-lg text-gray-600 text-center max-w-2xl">
            This presentation and accompanying audio are loaded directly from your GitHub repository.
            View the document in full screen for an immersive experience.
        </p>

        <!-- PDF Viewer Section -->
        <div class="w-full flex flex-col items-center mt-6">
            <div class="pdf-controls">
                <button id="fullscreenButton" class="interactive-button bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg text-sm flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 0h-4m4 0l-5-5" />
                    </svg>
                    <span>Full Screen PDF</span>
                </button>
            </div>
            <!-- PDF Viewer: Directly linking to the PDF in your GitHub repo -->
            <iframe id="pdfViewer" src="https://raw.githubusercontent.com/imelijah88/aDayInTheirShoes/main/A%20Day%20In%20Their%20Shoes1.pdf" class="pdf-viewer" frameborder="0">
                Your browser does not support PDFs or there was an issue loading the PDF from GitHub.
            </iframe>
        </div>

        <!-- Audio Player Controls -->
        <div class="w-full max-w-sm flex flex-col items-center space-y-4 pt-6">
            <h2 class="text-xl font-semibold text-gray-700">Audio Narration</h2>
            <!-- Audio element: Directly linking to the MP3 in your GitHub repo -->
            <!-- IMPORTANT: If audio fails, copy the EXACT "Raw" URL for your audio.mp3 file from GitHub and paste it here. -->
            <audio id="myAudio" src="https://raw.githubusercontent.com/imelijah88/aDayInTheirShoes/main/audio.mp3" preload="auto" class="w-full"></audio>

            <!-- Play/Pause Button -->
            <button id="playPauseButton" class="interactive-button py-3 px-6 rounded-full text-lg">
                Play Audio
            </button>

            <!-- Display area for messages (e.g., error messages) -->
            <div id="messageBox" class="text-base text-gray-700 mt-2 text-center w-full min-h-[2rem] flex items-center justify-center"></div>
        </div>
    </div>

    <script>
        // Get references to elements
        const myAudio = document.getElementById('myAudio');
        const playPauseButton = document.getElementById('playPauseButton');
        const messageBox = document.getElementById('messageBox');
        const pdfViewer = document.getElementById('pdfViewer');
        const fullscreenButton = document.getElementById('fullscreenButton');

        let isPlaying = false; // Track the current playback state

        // Function to show messages in the message box
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.classList.remove('error-message'); // Clear previous error styling

            if (type === 'error') {
                messageBox.classList.add('error-message');
            } else {
                messageBox.classList.remove('text-red-600');
                messageBox.classList.add('text-blue-600'); // Default info color
            }
        }

        // Fullscreen toggle for PDF viewer
        fullscreenButton.addEventListener('click', () => {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                pdfViewer.requestFullscreen().catch(err => {
                    showMessage(`Error attempting full-screen: ${err.message} (Your browser might block full-screen without a direct user gesture).`, 'error');
                    console.error("Fullscreen error:", err);
                });
            }
        });

        // Update button text when fullscreen mode changes
        document.addEventListener('fullscreenchange', () => {
            if (document.fullscreenElement) {
                fullscreenButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    <span>Exit Full Screen</span>
                `;
            } else {
                fullscreenButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 0h-4m4 0l-5-5" />
                    </svg>
                    <span>Full Screen PDF</span>
                `;
            }
        });

        // Event listener for the play/pause button
        playPauseButton.addEventListener('click', async () => {
            if (!myAudio.src) {
                showMessage("Audio source not set. Cannot play.", 'error'); // More direct message
                return;
            }

            try {
                if (isPlaying) {
                    myAudio.pause();
                    playPauseButton.textContent = 'Play Audio';
                    isPlaying = false;
                    showMessage('Audio paused.');
                } else {
                    await myAudio.play();
                    playPauseButton.textContent = 'Pause Audio';
                    isPlaying = true;
                    showMessage('Audio playing...');
                }
            } catch (error) {
                let specificMessage = `Playback failed: ${error.message}.`;
                if (error.name === "NotAllowedError") {
                    specificMessage = "Autoplay prevented. Please click 'Play Audio' to start.";
                } else if (error.name === "AbortError") {
                    specificMessage = "Playback aborted.";
                } else if (error.name === "NotFoundError" || myAudio.networkState === HTMLMediaElement.NETWORK_NO_SOURCE) {
                    specificMessage = `Audio file not found or could not be loaded from "${myAudio.currentSrc}". Please check the GitHub file path and accessibility.`;
                }
                showMessage(`Audio Error: ${specificMessage}`, 'error');
                console.error("Audio playback error:", error);
                console.error("Audio current source:", myAudio.currentSrc); // Log the actual source being used
                isPlaying = false;
                playPauseButton.textContent = 'Play Audio';
            }
        });

        // Audio event listeners
        myAudio.addEventListener('play', () => {
            isPlaying = true;
            playPauseButton.textContent = 'Pause Audio';
            showMessage('Audio playing...');
        });

        myAudio.addEventListener('pause', () => {
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
            showMessage('Audio paused.');
        });

        myAudio.addEventListener('ended', () => {
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
            showMessage('Audio finished.');
        });

        myAudio.addEventListener('loadedmetadata', () => {
            console.log("Audio metadata loaded. Duration:", myAudio.duration);
            showMessage('Audio loaded. Click "Play Audio" to start.');
        });

        myAudio.addEventListener('error', (e) => {
            const error = e.target.error;
            let errorMessage = `An audio error occurred (Code: ${error ? error.code : 'unknown'}).`;
            console.error("Audio element error event triggered:", e);
            console.error("MediaError object:", error);
            console.error("Audio current source on error:", myAudio.currentSrc); // Log the source when error occurs

            if (error) {
                switch (error.code) {
                    case MediaError.MEDIA_ERR_ABORTED:
                        errorMessage = 'Audio load aborted.';
                        break;
                    case MediaError.MEDIA_ERR_NETWORK:
                        errorMessage = 'A network error prevented audio download. Check your internet connection.';
                        break;
                    case MediaError.MEDIA_ERR_DECODE:
                        errorMessage = 'The audio could not be decoded. Ensure it\'s a valid MP3 file.';
                        break;
                    case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
                        errorMessage = `The audio format is not supported or the file could not be accessed from "${myAudio.currentSrc}". Please check the GitHub file path and its format.`;
                        break;
                    default:
                        errorMessage = `An unspecified audio error occurred (Code: ${error.code}).`;
                        if (error.message) {
                            errorMessage += ` Message: ${error.message}`;
                        }
                }
            } else {
                errorMessage = 'An unknown audio error occurred with no specific error object. This often indicates the audio file was not found or accessible.';
            }

            showMessage(`Audio Load Error: ${errorMessage}`, 'error');
            console.error("Audio element error details:", errorMessage);
            isPlaying = false;
            playPauseButton.textContent = 'Play Audio';
        });

        // Initial load check (with a small delay to ensure DOM is ready)
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log("Window loaded. Attempting to load files from GitHub.");
                console.log("PDF Viewer source:", pdfViewer.src);
                console.log("Audio Player source:", myAudio.src);

                // No manual selection, so directly try to load and show messages
                myAudio.load(); // Explicitly try to load the audio
                showMessage('Attempting to load presentation and audio from GitHub...');
            }, 100); // Small delay
        });
    </script>
</body>
</html>
